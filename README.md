# Деловой калькулятор BizCalc
Деловой калькулятор **BizCalc** представляет собой электронную таблицу, поддерживающая операции сложения (+), вычитания (-), умножения (*), деления (/) и возведения в степень (^), круглые скобки и унарный минус, а также различные функции, аргументы которых разделяются знаком двоеточия. 

Определение формулы начинается со знака равно (=). Ссылки на ячейки оформляются в виде [Код_колонки][Код_строки], например A1. 

Для начала настроены следующие функции:

* **random ()** - получение случайного числа **от 0 до 1**;
* **round (аргумент)** - округление значения аргумента до целого числа; доступны модификации функции **round2**, **round3**, **round4**, которые округляют значение аргумента **до 2, 3 и 4 знаков** после запятой соответственно;
* **sum (аргумент1; аргумент2; ...)** - сумма значений аргументов;
* **min (аргумент1; аргумент2; ...)** - минимальное значение из всех значений аргументов;
* **max (аргумент1; аргумент2; ...)** - максимальное значение из всех значений аргументов;
* **if (условие; выражение_если_условие_истинно[; выражение_если_условие_ложно])** - проверка на условие с вычислением и возвратом значения первого выражения при истинности условия и второго - при его ложности; второе выражение опционально, при его отсутствие функция возвращает **0**.

В папке **/demo** доступны пользовательские файлы, которые можно скачать на диск, затем открыть в приложении, отредактировать их, после чего сохранить сделанные изменения, перезаписав существующий локальный файл или создав новый. 

Для удобства настроены следующие сочетания клавиш:
* **Ctrl+S** - сохранение текущей таблицы в JSON-файл;
* **Ctrl+O** - загрузка JSON-файла в текущую таблицу;
* **Ctrl+Q** - очистка текущей таблицы.

Исходный код приложения написан в следующем **стиле**:
1. Весь функцонал приложения оформлен в виде классов, включая веб-компоненты, созданные путем расширения класса HTMLElement или его потомков.
2. Проект содержит только файлы *.js и *.css, а также единственный файл index.html, в котором устанавливаются глобальные параметры приложения и который используется в качестве точки входа в приложение. 
3. Код приложения написан в стандарте ES2015 без использования сторонних библиотек.
4. Все вычисления выполняются на стороне клиента.

В приложении реализованы следующие **решения**:
1. Ячейки таблицы оформляются в виде объектов класса Cell.
2. В объекте ячейки сохраняются помимо выводимого на интерфейс текстового значения также ее тип (число, формула, строка) в виде атрибута класса ValueTypes, числовое значение, строка формулы и строка текста. 
3. В источнике данных TableData веб-компонета таблицы используются следующие Map-кеши с ключами в виде текстового имени ячейки:
* объекты ячеек класса Cell, которые инициализируются в момент запуска приложения;
* массивы токенов класса Token, на которые разбиваются строки формул при их первичном вводе и последующем редактировании;
* вводимые и редактируемые числовые значения типа Number.

